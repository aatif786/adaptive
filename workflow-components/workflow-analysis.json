{
  "nodes": [
    {
      "index": 0,
      "id": "d532845c-49cb-4830-97a8-b4acf2f0c1c1",
      "name": "Main Webhook",
      "type": "n8n-nodes-base.webhook",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -4180,
        450
      ]
    },
    {
      "index": 1,
      "id": "f28a9d2b-47a6-4d55-bc6b-ef776f4464c9",
      "name": "Session State Manager",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": false,
      "position": [
        -3740,
        350
      ]
    },
    {
      "index": 2,
      "id": "aa6fd26e-4342-4ee8-a8bd-caac1935ac77",
      "name": "Course Completion",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        0,
        0
      ]
    },
    {
      "index": 3,
      "id": "54256739-0559-4806-a0e6-fdf2f73866fd",
      "name": "Concept Card Handler",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -660,
        1075
      ]
    },
    {
      "index": 4,
      "id": "2a55c1e2-d092-40e6-a2d6-f2c196a4f0a7",
      "name": "Assessment Handler",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -660,
        1275
      ]
    },
    {
      "index": 5,
      "id": "2a7f4f29-fd10-48f2-b75d-4567c928cfe0",
      "name": "Process Grading",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -1760,
        450
      ]
    },
    {
      "index": 6,
      "id": "ae9f1a2b-60b1-4f22-909d-1ab51c87010d",
      "name": "Prompt Exercise Handler",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -1320,
        1475
      ]
    },
    {
      "index": 7,
      "id": "d42a720e-a909-4bde-ad75-4e1760793faa",
      "name": "Merge Responses",
      "type": "n8n-nodes-base.merge",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        220,
        200
      ]
    },
    {
      "index": 8,
      "id": "bfd6fc8e-33ac-4795-9036-aeae71a30173",
      "name": "Webhook Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        660,
        200
      ]
    },
    {
      "index": 9,
      "id": "c3aceff9-8ba6-4058-957c-d92b81a3daef",
      "name": "Reset Session Webhook",
      "type": "n8n-nodes-base.webhook",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -4400,
        1735
      ]
    },
    {
      "index": 10,
      "id": "a788c2e3-36bb-421b-8731-08e8ba832ac0",
      "name": "Reset Session",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": false,
      "position": [
        -4180,
        1735
      ]
    },
    {
      "index": 11,
      "id": "593bb970-f738-4e13-a49f-d197f720b8ff",
      "name": "Reset Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -3960,
        1735
      ]
    },
    {
      "index": 12,
      "id": "f9cfaed0-e502-45ff-bc3a-97e4063b74bc",
      "name": "Init Course Data",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -3960,
        350
      ]
    },
    {
      "index": 13,
      "id": "ddb6f37f-de10-4755-bcb2-322171d87022",
      "name": "Limit Data",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": false,
      "position": [
        440,
        200
      ]
    },
    {
      "index": 14,
      "id": "69443795-3e8d-4568-82d9-75c0c4d977a8",
      "name": "When clicking 'Test workflow'",
      "type": "n8n-nodes-base.manualTrigger",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -4400,
        250
      ]
    },
    {
      "index": 15,
      "id": "18dc64d6-1a02-4507-b3b8-0f7dc64c5c90",
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -4180,
        250
      ]
    },
    {
      "index": 16,
      "id": "161de99a-7b50-4f82-8fad-858b037b8088",
      "name": "Grade Assessment AI Call",
      "type": "n8n-nodes-base.httpRequest",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -1980,
        450
      ]
    },
    {
      "index": 17,
      "id": "be6c4756-8d39-4edd-a4d1-ac8a09a1d37b",
      "name": "Generate New Concept Prompt",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -2200,
        1371
      ]
    },
    {
      "index": 18,
      "id": "05c56191-1687-4042-9daf-55e6a059bdc6",
      "name": "Generate New Concept AI Call",
      "type": "n8n-nodes-base.httpRequest",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -1980,
        1371
      ]
    },
    {
      "index": 19,
      "id": "85da8ca4-5e62-49bf-8073-ca187e12d49a",
      "name": "Core Orchestrator",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -3520,
        350
      ]
    },
    {
      "index": 20,
      "id": "d6c7226d-a101-4894-9460-53a70e297a40",
      "name": "Core Router",
      "type": "n8n-nodes-base.switch",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -3300,
        287
      ]
    },
    {
      "index": 21,
      "id": "d533057c-0297-473b-b4b9-baa69afa73d1",
      "name": "Adaptive Orchestrator AI Call",
      "type": "n8n-nodes-base.httpRequest",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -2860,
        875
      ]
    },
    {
      "index": 22,
      "id": "2420d12f-4baf-487b-946f-1ee34c25f512",
      "name": "Process Adaptive Orchestrator Decision",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -2640,
        875
      ]
    },
    {
      "index": 23,
      "id": "37d29304-8841-424a-ac9c-9e55c72d0f56",
      "name": "Smart Reply Generator Prompt",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -440,
        996
      ]
    },
    {
      "index": 24,
      "id": "b3949255-4c59-417e-985e-a158b6d70b53",
      "name": "Smart Reply Generator AI Call",
      "type": "n8n-nodes-base.httpRequest",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -220,
        996
      ]
    },
    {
      "index": 25,
      "id": "74959534-a145-472e-99b2-51199699ffe2",
      "name": "Process Smart Replies",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": false,
      "position": [
        0,
        996
      ]
    },
    {
      "index": 26,
      "id": "595ebb3c-f347-46f2-8d5d-25dfeee6526b",
      "name": "Generate Prompt Exercise Prompt",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -1100,
        1475
      ]
    },
    {
      "index": 27,
      "id": "3575f197-7a1e-4410-b8f1-c2ed369c2c9f",
      "name": "Generate Prompt Exercise Evaluation AI Call",
      "type": "n8n-nodes-base.httpRequest",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -1980,
        650
      ]
    },
    {
      "index": 28,
      "id": "b12839bf-30c0-480e-89bf-fd421dcd9e51",
      "name": "Generate Prompt Exercise Generate AI Call",
      "type": "n8n-nodes-base.httpRequest",
      "hasCode": false,
      "hasPrompt": false,
      "position": [
        -880,
        1475
      ]
    },
    {
      "index": 29,
      "id": "26b5b049-d975-45a7-b455-4305170199de",
      "name": "Process Prompt Evaluation",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -1760,
        650
      ]
    },
    {
      "index": 30,
      "id": "54560bf3-5b60-4b13-bc9a-7a791d4c925e",
      "name": "Generate Assessment Grading Prompt",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -2200,
        450
      ]
    },
    {
      "index": 31,
      "id": "3c50e1c8-db67-4701-a15a-0442e5ccfe22",
      "name": "Process Generated Prompt Exercise",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -660,
        1475
      ]
    },
    {
      "index": 32,
      "id": "09b3fb2e-a46c-4a40-aab2-af9903280fe0",
      "name": "Generate Adaptive Orchestrator Router Prompt",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -3080,
        875
      ]
    },
    {
      "index": 33,
      "id": "ecf45b14-bee3-48af-828b-2162c6836451",
      "name": "Generate Evaluate Prompt Excercise Prompt",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -2200,
        650
      ]
    },
    {
      "index": 34,
      "id": "cfb2c81b-113a-4c72-9d91-009436e94d37",
      "name": "Adaptive Tool Router",
      "type": "n8n-nodes-base.switch",
      "hasCode": false,
      "hasPrompt": true,
      "position": [
        -2420,
        833
      ]
    },
    {
      "index": 35,
      "id": "ba3e15bd-373b-4386-8592-430322bf4df1",
      "name": "Core Tool Router",
      "type": "n8n-nodes-base.switch",
      "hasCode": false,
      "hasPrompt": true,
      "position": [
        -1540,
        1275
      ]
    },
    {
      "index": 36,
      "id": "4cbaf678-cbcb-40c0-9b63-23718d42cbb4",
      "name": "Welcome Message Handler",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        0,
        200
      ]
    },
    {
      "index": 37,
      "id": "abb2e55b-e968-4306-a18e-c641a70002a9",
      "name": "Complete Concept Handler",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -660,
        875
      ]
    },
    {
      "index": 38,
      "id": "878f49b5-1fd1-4f9c-b23f-21b9b335b670",
      "name": "Insert Concept Handler",
      "type": "n8n-nodes-base.code",
      "hasCode": true,
      "hasPrompt": true,
      "position": [
        -1760,
        1371
      ]
    }
  ],
  "codeBlocks": [
    {
      "nodeName": "Session State Manager",
      "nodeId": "f28a9d2b-47a6-4d55-bc6b-ef776f4464c9",
      "codeLength": 1707,
      "preview": "// CLEAN Session State Manager - ONLY manages state storage\n// No business logic, no routing, no decisions\n\nconst sessionId = $json.sessionId || 'default-session';\nconst action = $json.action || 'star..."
    },
    {
      "nodeName": "Course Completion",
      "nodeId": "aa6fd26e-4342-4ee8-a8bd-caac1935ac77",
      "codeLength": 1449,
      "preview": "// Course Completion Handler\nconst sessionId = $json.sessionId;\nconst session = $json.sessionState;\n\n// Calculate final statistics\nconst totalConcepts = session.completedConcepts.length;\nconst coreCon..."
    },
    {
      "nodeName": "Concept Card Handler",
      "nodeId": "54256739-0559-4806-a0e6-fdf2f73866fd",
      "codeLength": 1697,
      "preview": "// Fix for Concept Card Handler\n// Location: \"Concept Card Handler\" node\n\nconst concept = $json.currentConcept;\nconst sessionId = $json.sessionId;\nconst learnerNote = $json.learnerInput?.note;\n\n// Get..."
    },
    {
      "nodeName": "Assessment Handler",
      "nodeId": "2a55c1e2-d092-40e6-a2d6-f2c196a4f0a7",
      "codeLength": 1690,
      "preview": "// Fix for Assessment Handler\n// Location: \"Assessment Handler\" node\n\nconst concept = $json.currentConcept;\nconst sessionId = $json.sessionId;\nconst learnerAnswer = $json.learnerInput?.answer;\nconst s..."
    },
    {
      "nodeName": "Process Grading",
      "nodeId": "2a7f4f29-fd10-48f2-b75d-4567c928cfe0",
      "codeLength": 3343,
      "preview": "// Process Combined Grading and Knowledge Analysis\nconst result = JSON.parse($json.choices[0].message.content);\n\n// Get data from the pipeline (from Grade Assessment AI Call)\nconst sessionId = $('Gene..."
    },
    {
      "nodeName": "Prompt Exercise Handler",
      "nodeId": "ae9f1a2b-60b1-4f22-909d-1ab51c87010d",
      "codeLength": 2294,
      "preview": "// Simple Fix for Prompt Exercise Handler\n// This checks session for any previously generated enhanced task\n\nconst concept = $json.currentConcept;\nconst sessionId = $json.sessionId;\nconst session = $g..."
    },
    {
      "nodeName": "Reset Session",
      "nodeId": "a788c2e3-36bb-421b-8731-08e8ba832ac0",
      "codeLength": 359,
      "preview": "// Reset Session\nconst sessionId = $json.query?.sessionId || 'default-session';\n\n// Clear session data\nconst sessionState = $getWorkflowStaticData('global');\nif (sessionState.sessions && sessionState...."
    },
    {
      "nodeName": "Init Course Data",
      "nodeId": "f9cfaed0-e502-45ff-bc3a-97e4063b74bc",
      "codeLength": 6013,
      "preview": "// Extract webhook data from the first item in the array\nconst webhookData = $input.first().json.body;\n\n// Add course data\nreturn {\n  sessionId: webhookData.sessionId,\n  userName: webhookData.userName..."
    },
    {
      "nodeName": "Limit Data",
      "nodeId": "ddb6f37f-de10-4755-bcb2-322171d87022",
      "codeLength": 164,
      "preview": "// Extract Response Data\nconst responseData = $json.responseData;\n\nif (!responseData) {\n  throw new Error('No responseData found in input');\n}\n\nreturn responseData;..."
    },
    {
      "nodeName": "Generate New Concept Prompt",
      "nodeId": "be6c4756-8d39-4edd-a4d1-ac8a09a1d37b",
      "codeLength": 1695,
      "preview": "// Generate Concept Prompt - Prepares prompt for creating new adaptive concepts\nconst messages = [\n  {\n    role: \"system\",\n    content: \"Generate a new mini-concept to address a specific learning gap...."
    },
    {
      "nodeName": "Core Orchestrator",
      "nodeId": "85da8ca4-5e62-49bf-8073-ca187e12d49a",
      "codeLength": 9922,
      "preview": "// Combined Routing & Core Orchestrator - FIXED\n// Handles both routing decisions AND simple deterministic transitions\n\nconst sessionId = $json.sessionId;\nconst action = $json.action;\nconst learnerInp..."
    },
    {
      "nodeName": "Process Adaptive Orchestrator Decision",
      "nodeId": "2420d12f-4baf-487b-946f-1ee34c25f512",
      "codeLength": 9653,
      "preview": "// Process Adaptive Orchestrator Decision - ENHANCED WITH CONCEPT LOADING\nconst orchestratorDecision = JSON.parse($json.choices[0].message.content);\n\nconst sessionId = $('Generate Adaptive Orchestrato..."
    },
    {
      "nodeName": "Smart Reply Generator Prompt",
      "nodeId": "37d29304-8841-424a-ac9c-9e55c72d0f56",
      "codeLength": 8102,
      "preview": "// Smart Reply Generator for 6 Input Handlers\nconst toolType = $json.responseData?.toolType;\nconst toolData = $json.responseData?.toolData;\nconst sessionId = $json.sessionId;\n\n// Get session for conte..."
    },
    {
      "nodeName": "Process Smart Replies",
      "nodeId": "74959534-a145-472e-99b2-51199699ffe2",
      "codeLength": 606,
      "preview": "// Process Smart Replies - Add generated replies to response\nconst smartReplies = JSON.parse($json.choices[0].message.content);\n\n// Get data from the pipeline (from Smart Reply Generator AI Call)\ncons..."
    },
    {
      "nodeName": "Generate Prompt Exercise Prompt",
      "nodeId": "595ebb3c-f347-46f2-8d5d-25dfeee6526b",
      "codeLength": 2523,
      "preview": "// Generate Prompt Exercise - Creates targeted prompt exercises\nconst sessionId = $json.sessionId;\nconst session = $getWorkflowStaticData('global').sessions[sessionId];\n\nif (!session) {\n  throw new Er..."
    },
    {
      "nodeName": "Process Prompt Evaluation",
      "nodeId": "26b5b049-d975-45a7-b455-4305170199de",
      "codeLength": 2812,
      "preview": "// This node processes the AI's evaluation of the user's prompt\n\nconst evaluationResult = JSON.parse($json.choices[0].message.content);\n\n// Get data from the pipeline (from Generate Prompt Exercise Ev..."
    },
    {
      "nodeName": "Generate Assessment Grading Prompt",
      "nodeId": "54560bf3-5b60-4b13-bc9a-7a791d4c925e",
      "codeLength": 2764,
      "preview": "// Generate Assessment Grading Prompt - FIXED to properly get learner answer\nconst sessionId = $json.sessionId;\nconst session = $getWorkflowStaticData('global').sessions[sessionId];\n\nif (!session) {\n ..."
    },
    {
      "nodeName": "Process Generated Prompt Exercise",
      "nodeId": "3c50e1c8-db67-4701-a15a-0442e5ccfe22",
      "codeLength": 1486,
      "preview": "// Process Generated Prompt Exercise - FIXED\nconst exerciseData = JSON.parse($json.choices[0].message.content);\n\n// Get data from the pipeline\nconst sessionId = $('Generate Prompt Exercise Prompt').fi..."
    },
    {
      "nodeName": "Generate Adaptive Orchestrator Router Prompt",
      "nodeId": "09b3fb2e-a46c-4a40-aab2-af9903280fe0",
      "codeLength": 8611,
      "preview": "// Adaptive Orchestrator Router Prompt - WITH PROMPT EXERCISE INTELLIGENCE\n// Get session directly from global\nconst sessionId = $json.sessionId;\nconst session = $getWorkflowStaticData('global').sessi..."
    },
    {
      "nodeName": "Generate Evaluate Prompt Excercise Prompt",
      "nodeId": "ecf45b14-bee3-48af-828b-2162c6836451",
      "codeLength": 2924,
      "preview": "// This node prepares the prompt for evaluating user's prompt exercise submission\n\n// Prepare Prompt Evaluation Request\nconst sessionId = $json.sessionId;\nconst session = $getWorkflowStaticData('globa..."
    },
    {
      "nodeName": "Welcome Message Handler",
      "nodeId": "4cbaf678-cbcb-40c0-9b63-23718d42cbb4",
      "codeLength": 1059,
      "preview": "// Fix for Welcome Message Handler\n// Location: \"Welcome Message\" node\n\nconst sessionId = $json.sessionId;\nconst courseTopic = $json.courseTopic;\n\n// Get session from global\nconst session = $getWorkfl..."
    },
    {
      "nodeName": "Complete Concept Handler",
      "nodeId": "abb2e55b-e968-4306-a18e-c641a70002a9",
      "codeLength": 3440,
      "preview": "// Fix for Complete Concept Handler\n// Location: \"Complete Concept\" node\n\nconst sessionId = $json.sessionId;\nconst currentConcept = $json.currentConcept || $json.sessionState?.currentConcept;\nconst se..."
    },
    {
      "nodeName": "Insert Concept Handler",
      "nodeId": "878f49b5-1fd1-4f9c-b23f-21b9b335b670",
      "codeLength": 2918,
      "preview": "// Fix for Insert Concept Handler\n// Location: \"Insert Concept\" node\n\nconst newConcept = JSON.parse($json.choices[0].message.content);\n\n// Get data from the pipeline (from Generate New Concept AI Call..."
    }
  ],
  "prompts": [
    {
      "nodeName": "Course Completion",
      "nodeId": "aa6fd26e-4342-4ee8-a8bd-caac1935ac77",
      "path": "parameters.jsCode",
      "preview": "// Course Completion Handler\nconst sessionId = $json.sessionId;\nconst session = $json.sessionState;\n...",
      "fullLength": 1449
    },
    {
      "nodeName": "Concept Card Handler",
      "nodeId": "54256739-0559-4806-a0e6-fdf2f73866fd",
      "path": "parameters.jsCode",
      "preview": "// Fix for Concept Card Handler\n// Location: \"Concept Card Handler\" node\n\nconst concept = $json.curr...",
      "fullLength": 1697
    },
    {
      "nodeName": "Assessment Handler",
      "nodeId": "2a55c1e2-d092-40e6-a2d6-f2c196a4f0a7",
      "path": "parameters.jsCode",
      "preview": "// Fix for Assessment Handler\n// Location: \"Assessment Handler\" node\n\nconst concept = $json.currentC...",
      "fullLength": 1690
    },
    {
      "nodeName": "Process Grading",
      "nodeId": "2a7f4f29-fd10-48f2-b75d-4567c928cfe0",
      "path": "parameters.jsCode",
      "preview": "// Process Combined Grading and Knowledge Analysis\nconst result = JSON.parse($json.choices[0].messag...",
      "fullLength": 3343
    },
    {
      "nodeName": "Prompt Exercise Handler",
      "nodeId": "ae9f1a2b-60b1-4f22-909d-1ab51c87010d",
      "path": "parameters.jsCode",
      "preview": "// Simple Fix for Prompt Exercise Handler\n// This checks session for any previously generated enhanc...",
      "fullLength": 2294
    },
    {
      "nodeName": "Init Course Data",
      "nodeId": "f9cfaed0-e502-45ff-bc3a-97e4063b74bc",
      "path": "parameters.jsCode",
      "preview": "// Extract webhook data from the first item in the array\nconst webhookData = $input.first().json.bod...",
      "fullLength": 6013
    },
    {
      "nodeName": "Generate New Concept Prompt",
      "nodeId": "be6c4756-8d39-4edd-a4d1-ac8a09a1d37b",
      "path": "parameters.jsCode",
      "preview": "// Generate Concept Prompt - Prepares prompt for creating new adaptive concepts\nconst messages = [\n ...",
      "fullLength": 1695
    },
    {
      "nodeName": "Core Orchestrator",
      "nodeId": "85da8ca4-5e62-49bf-8073-ca187e12d49a",
      "path": "parameters.jsCode",
      "preview": "// Combined Routing & Core Orchestrator - FIXED\n// Handles both routing decisions AND simple determi...",
      "fullLength": 9922
    },
    {
      "nodeName": "Process Adaptive Orchestrator Decision",
      "nodeId": "2420d12f-4baf-487b-946f-1ee34c25f512",
      "path": "parameters.jsCode",
      "preview": "// Process Adaptive Orchestrator Decision - ENHANCED WITH CONCEPT LOADING\nconst orchestratorDecision...",
      "fullLength": 9653
    },
    {
      "nodeName": "Smart Reply Generator Prompt",
      "nodeId": "37d29304-8841-424a-ac9c-9e55c72d0f56",
      "path": "parameters.jsCode",
      "preview": "// Smart Reply Generator for 6 Input Handlers\nconst toolType = $json.responseData?.toolType;\nconst t...",
      "fullLength": 8102
    },
    {
      "nodeName": "Generate Prompt Exercise Prompt",
      "nodeId": "595ebb3c-f347-46f2-8d5d-25dfeee6526b",
      "path": "parameters.jsCode",
      "preview": "// Generate Prompt Exercise - Creates targeted prompt exercises\nconst sessionId = $json.sessionId;\nc...",
      "fullLength": 2523
    },
    {
      "nodeName": "Process Prompt Evaluation",
      "nodeId": "26b5b049-d975-45a7-b455-4305170199de",
      "path": "parameters.jsCode",
      "preview": "// This node processes the AI's evaluation of the user's prompt\n\nconst evaluationResult = JSON.parse...",
      "fullLength": 2812
    },
    {
      "nodeName": "Generate Assessment Grading Prompt",
      "nodeId": "54560bf3-5b60-4b13-bc9a-7a791d4c925e",
      "path": "parameters.jsCode",
      "preview": "// Generate Assessment Grading Prompt - FIXED to properly get learner answer\nconst sessionId = $json...",
      "fullLength": 2764
    },
    {
      "nodeName": "Process Generated Prompt Exercise",
      "nodeId": "3c50e1c8-db67-4701-a15a-0442e5ccfe22",
      "path": "parameters.jsCode",
      "preview": "// Process Generated Prompt Exercise - FIXED\nconst exerciseData = JSON.parse($json.choices[0].messag...",
      "fullLength": 1486
    },
    {
      "nodeName": "Generate Adaptive Orchestrator Router Prompt",
      "nodeId": "09b3fb2e-a46c-4a40-aab2-af9903280fe0",
      "path": "parameters.jsCode",
      "preview": "// Adaptive Orchestrator Router Prompt - WITH PROMPT EXERCISE INTELLIGENCE\n// Get session directly f...",
      "fullLength": 8611
    },
    {
      "nodeName": "Generate Evaluate Prompt Excercise Prompt",
      "nodeId": "ecf45b14-bee3-48af-828b-2162c6836451",
      "path": "parameters.jsCode",
      "preview": "// This node prepares the prompt for evaluating user's prompt exercise submission\n\n// Prepare Prompt...",
      "fullLength": 2924
    },
    {
      "nodeName": "Adaptive Tool Router",
      "nodeId": "cfb2c81b-113a-4c72-9d91-009436e94d37",
      "path": "parameters.rules.values.3.conditions.conditions.0.leftValue",
      "preview": "={{ ['concept_card', 'assessment', 'prompt_exercise'].includes($json.nextAction) }}...",
      "fullLength": 83
    },
    {
      "nodeName": "Core Tool Router",
      "nodeId": "ba3e15bd-373b-4386-8592-430322bf4df1",
      "path": "parameters.rules.values.0.conditions.conditions.0.leftValue",
      "preview": "={{ ['concept_card', 'insert_concept'].includes($json.nextAction) }}...",
      "fullLength": 68
    },
    {
      "nodeName": "Welcome Message Handler",
      "nodeId": "4cbaf678-cbcb-40c0-9b63-23718d42cbb4",
      "path": "parameters.jsCode",
      "preview": "// Fix for Welcome Message Handler\n// Location: \"Welcome Message\" node\n\nconst sessionId = $json.sess...",
      "fullLength": 1059
    },
    {
      "nodeName": "Complete Concept Handler",
      "nodeId": "abb2e55b-e968-4306-a18e-c641a70002a9",
      "path": "parameters.jsCode",
      "preview": "// Fix for Complete Concept Handler\n// Location: \"Complete Concept\" node\n\nconst sessionId = $json.se...",
      "fullLength": 3440
    },
    {
      "nodeName": "Insert Concept Handler",
      "nodeId": "878f49b5-1fd1-4f9c-b23f-21b9b335b670",
      "path": "parameters.jsCode",
      "preview": "// Fix for Insert Concept Handler\n// Location: \"Insert Concept\" node\n\nconst newConcept = JSON.parse(...",
      "fullLength": 2918
    }
  ],
  "connections": {
    "Main Webhook": {
      "main": [
        null
      ]
    },
    "Session State Manager": {
      "main": [
        null
      ]
    },
    "Concept Card Handler": {
      "main": [
        null
      ]
    },
    "Assessment Handler": {
      "main": [
        null
      ]
    },
    "Process Grading": {
      "main": [
        null
      ]
    },
    "Prompt Exercise Handler": {
      "main": [
        null
      ]
    },
    "Course Completion": {
      "main": [
        null
      ]
    },
    "Merge Responses": {
      "main": [
        null
      ]
    },
    "Reset Session Webhook": {
      "main": [
        null
      ]
    },
    "Reset Session": {
      "main": [
        null
      ]
    },
    "Init Course Data": {
      "main": [
        null
      ]
    },
    "Limit Data": {
      "main": [
        null
      ]
    },
    "When clicking 'Test workflow'": {
      "main": [
        null
      ]
    },
    "Edit Fields": {
      "main": [
        null
      ]
    },
    "Grade Assessment AI Call": {
      "main": [
        null
      ]
    },
    "Generate New Concept Prompt": {
      "main": [
        null
      ]
    },
    "Generate New Concept AI Call": {
      "main": [
        null
      ]
    },
    "Core Orchestrator": {
      "main": [
        null
      ]
    },
    "Core Router": {
      "main": [
        null,
        null,
        null,
        null,
        null,
        null
      ]
    },
    "Adaptive Orchestrator AI Call": {
      "main": [
        null
      ]
    },
    "Process Adaptive Orchestrator Decision": {
      "main": [
        null
      ]
    },
    "Smart Reply Generator Prompt": {
      "main": [
        null
      ]
    },
    "Smart Reply Generator AI Call": {
      "main": [
        null
      ]
    },
    "Process Smart Replies": {
      "main": [
        null
      ]
    },
    "Generate Prompt Exercise Prompt": {
      "main": [
        null
      ]
    },
    "Generate Prompt Exercise Generate AI Call": {
      "main": [
        null
      ]
    },
    "Generate Prompt Exercise Evaluation AI Call": {
      "main": [
        null
      ]
    },
    "Process Prompt Evaluation": {
      "main": [
        null
      ]
    },
    "Generate Assessment Grading Prompt": {
      "main": [
        null
      ]
    },
    "Process Generated Prompt Exercise": {
      "main": [
        null
      ]
    },
    "Generate Adaptive Orchestrator Router Prompt": {
      "main": [
        null
      ]
    },
    "Generate Evaluate Prompt Excercise Prompt": {
      "main": [
        null
      ]
    },
    "Adaptive Tool Router": {
      "main": [
        null,
        null,
        null,
        null,
        null
      ]
    },
    "Core Tool Router": {
      "main": [
        null,
        null,
        null
      ]
    },
    "Welcome Message Handler": {
      "main": [
        null
      ]
    },
    "Complete Concept Handler": {
      "main": [
        null
      ]
    },
    "Insert Concept Handler": {
      "main": [
        null
      ]
    }
  },
  "nodesByType": {
    "n8n-nodes-base.webhook": [
      "Main Webhook",
      "Reset Session Webhook"
    ],
    "n8n-nodes-base.code": [
      "Session State Manager",
      "Course Completion",
      "Concept Card Handler",
      "Assessment Handler",
      "Process Grading",
      "Prompt Exercise Handler",
      "Reset Session",
      "Init Course Data",
      "Limit Data",
      "Generate New Concept Prompt",
      "Core Orchestrator",
      "Process Adaptive Orchestrator Decision",
      "Smart Reply Generator Prompt",
      "Process Smart Replies",
      "Generate Prompt Exercise Prompt",
      "Process Prompt Evaluation",
      "Generate Assessment Grading Prompt",
      "Process Generated Prompt Exercise",
      "Generate Adaptive Orchestrator Router Prompt",
      "Generate Evaluate Prompt Excercise Prompt",
      "Welcome Message Handler",
      "Complete Concept Handler",
      "Insert Concept Handler"
    ],
    "n8n-nodes-base.merge": [
      "Merge Responses"
    ],
    "n8n-nodes-base.respondToWebhook": [
      "Webhook Response",
      "Reset Response"
    ],
    "n8n-nodes-base.manualTrigger": [
      "When clicking 'Test workflow'"
    ],
    "n8n-nodes-base.set": [
      "Edit Fields"
    ],
    "n8n-nodes-base.httpRequest": [
      "Grade Assessment AI Call",
      "Generate New Concept AI Call",
      "Adaptive Orchestrator AI Call",
      "Smart Reply Generator AI Call",
      "Generate Prompt Exercise Evaluation AI Call",
      "Generate Prompt Exercise Generate AI Call"
    ],
    "n8n-nodes-base.switch": [
      "Core Router",
      "Adaptive Tool Router",
      "Core Tool Router"
    ]
  }
}